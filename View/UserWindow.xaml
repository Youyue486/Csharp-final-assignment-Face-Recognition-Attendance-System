<Window x:Class="Csharp_final_assignment_Face_Recognition_Attendance_System.View.UserWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Csharp_final_assignment_Face_Recognition_Attendance_System.ViewModel"
        Title="用户工作台" Height="600" Width="800">
    
    <Window.DataContext>
        <vm:UserDashboardViewModel />
    </Window.DataContext>

    <Grid>
        <!-- 左侧导航 -->
        <StackPanel Width="150" Background="#f5f5f5">
            <Button Content="刷新考勤" Command="{Binding LoadAttendanceCommand}" Margin="5"/>
            <Button Content="导出Excel" Command="{Binding ExportExcelCommand}" Margin="5"/>
            <Separator/>
            <Button Content="请假申请" Command="{Binding SubmitLeaveCommand}" Margin="5"/>
            <Button Content="出差申请" Command="{Binding SubmitTravelCommand}" Margin="5"/>
        </StackPanel>

        <!-- 主内容区 -->
        <TabControl Margin="10,0">
            <!-- 考勤记录 -->
            <TabItem Header="考勤记录">
                <DataGrid ItemsSource="{Binding AttendanceRecords}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="时间" Binding="{Binding CheckTime, StringFormat=yyyy-MM-dd HH:mm}"/>
                        <DataGridTextColumn Header="类型" Binding="{Binding CheckType}"/>
                        <DataGridTextColumn Header="工号" Binding="{Binding User.EmployeeNumber}"/>
                        <DataGridTextColumn Header="姓名" Binding="{Binding User.Name}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            
            <!-- 请假申请表单 -->
            <TabItem Header="请假申请">
                <StackPanel Margin="10">
                    <DatePicker SelectedDate="{Binding LeaveStartDate}" Header="开始日期"/>
                    <DatePicker SelectedDate="{Binding LeaveEndDate}" Header="结束日期"/>
                    <TextBox Text="{Binding LeaveReason}" Height="100" Margin="0,10" 
                            AcceptsReturn="True" TextWrapping="Wrap"/>
                </StackPanel>
            </TabItem>
            
            <!-- 出差申请表单 -->
            <TabItem Header="出差申请">
                <StackPanel Margin="10">
                    <DatePicker SelectedDate="{Binding TravelStartDate}" Header="开始日期"/>
                    <DatePicker SelectedDate="{Binding TravelEndDate}" Header="结束日期"/>
                    <TextBox Text="{Binding TravelReason}" Height="100" Margin="0,10" 
                            AcceptsReturn="True" TextWrapping="Wrap"/>
                </StackPanel>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
